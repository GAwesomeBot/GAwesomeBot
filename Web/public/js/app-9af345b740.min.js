/* GAwesomeBot by Gilbert - Available under the GPL V2 License - Some rights reserved - https://github.com/GilbertGobbels/GAwesomeBot */
const GAwesomeData={},GAwesomeUtil={},GAwesomePaths={};function saveFormState(){try{$("#builder-code-box").val(cm.getDoc().getValue())}catch(e){}initial_form_state=$("#form").serialize(),$("#form-submit span:nth-child(2)").html("Save")}GAwesomeData.activity={guildData:{}},GAwesomeData.blog={editor:{}},GAwesomeData.wiki={bookmarks:JSON.parse(localStorage.getItem("wiki-bookmarks"))||[],editor:{}},GAwesomeData.dashboard={},GAwesomeUtil.dashboard={},GAwesomeUtil.updateHeader=(()=>{const e=$("#nav-"+window.location.pathname.split("/")[1]);e&&e.addClass("is-tab")}),GAwesomeUtil.switchActivityLayout=(e=>{switch(e?localStorage.setItem("servers-layout",e):(e=localStorage.getItem("servers-layout"))||(localStorage.setItem("servers-layout","grid"),e=localStorage.getItem("servers-layout")),e){case"grid":$("#grid-layout-button").addClass("is-primary"),$("#list-layout").addClass("is-hidden"),$("#grid-layout").removeClass("is-hidden"),$("#list-layout-button").removeClass("is-primary");break;case"list":$("#list-layout-button").addClass("is-primary"),$("#list-layout").removeClass("is-hidden"),$("#grid-layout-button").removeClass("is-primary"),$("#grid-layout").addClass("is-hidden")}}),GAwesomeUtil.activityBanGuild=(e=>{confirm("Are you sure you want to remove this guild from the activity page? It will no longer be visible on this page.")&&$.post("/dashboard/servers/server-list?svrid=maintainer",{removeFromActivity:e}).done(()=>{const t=$(`#cardContent-${e}`);GAwesomeData.activity.guildData[e]=t.html(),t.html(`\n\t\t\t\t<a class="has-text-centered is-4" href="javascript:GAwesomeUtil.activityUnbanGuild('${e}')">\n    \t\t\t<span class="icon">\n        \t\t<i class="fa fa-refresh"></i>\n    \t\t\t</span>\n    \t\t\tUndo ban\n\t\t\t\t</a>\n\t\t\t`),t.addClass("has-text-centered")})}),GAwesomeUtil.activityUnbanGuild=(e=>{$.post("/dashboard/servers/server-list?svrid=maintainer",{unbanFromActivity:e}).done(()=>{const t=$(`#cardContent-${e}`);t.removeClass("has-text-centered"),t.html(GAwesomeUtil.activity.guildData[e])})}),GAwesomeUtil.activityViewportUpdate=(e=>{"activity"!==window.location.pathname.split("/")[1]&&"extensions"!==window.location.pathname.split("/")[1]||(e.matches?($(".header-search-box").removeClass("is-large"),document.getElementById("frame").style.paddingLeft="15px",document.getElementById("frame").style.paddingRight="15px","servers"===document.getElementById("search-select").value&&switchLayout("list")):($(".header-search-box").addClass("is-large"),document.getElementById("frame").style.paddingLeft="0px",document.getElementById("frame").style.paddingRight="0px"))}),GAwesomeUtil.uploadContent=((e,t)=>{if(e){const o=new FileReader;o.onload=function(e){GAwesomeData[t].editor.value(e.target.result)},o.readAsText(e[0]),document.getElementById("composer-content-upload").value=null}}),GAwesomeUtil.uploadCode=(e=>{if(e){const t=new FileReader;t.onload=function(e){GAwesomeData.builder.getDoc().setValue(e.target.result)},t.readAsText(e[0]),document.getElementById("builder-code-upload").value=null}}),GAwesomeUtil.downloadContent=(()=>{const e=new Blob([document.getElementById("composer-content").value],{type:"text/markdown;charset=utf-8"});saveAs(e,(document.getElementById("composer-title").value||"Untitled")+".md")}),GAwesomeUtil.downloadCode=(()=>{const e=new Blob([GAwesomeData.builder.getValue()],{type:"text/markdown;charset=utf-8"});saveAs(e,(document.getElementById("builder-title").value||"Untitled")+".gabext")}),GAwesomeUtil.searchWiki=(e=>{Turbolinks.visit("/wiki?q="+encodeURIComponent(e))}),GAwesomeUtil.getBookmarkLink=(e=>window.location.pathname.split("/").slice(-1)[0]+"#"+e),GAwesomeUtil.bookmarkWikiSection=(e=>{const t=GAwesomeUtil.getBookmarkLink(e.parentNode.id);GAwesomeData.wiki.bookmarks.indexOf(t)>-1?GAwesomeData.wiki.bookmarks.splice(GAwesomeData.wiki.bookmarks.indexOf(t),1):GAwesomeData.wiki.bookmarks.push(t),localStorage.setItem("wiki-bookmarks",JSON.stringify(GAwesomeData.wiki.bookmarks)),$(e).toggleClass("is-dark is-text"),GAwesomeUtil.populateWikiBookmarks()}),GAwesomeUtil.populateWikiSections=(()=>{let e="<ul>";const t=document.getElementById("frame").querySelectorAll("h1, h2, h3");for(let o=0;o<t.length;o++)o>0&&"H3"!==t[o].tagName&&t[o-1]&&"H3"===t[o-1].tagName&&(e+="</ul>"),e+="<li>","H3"===t[o].tagName&&(o>0&&t[o-1]&&"H3"!==t[o-1].tagName||0===o)&&(e+="<ul>"),e+="<a class='heading-shortcut-link' href='#"+t[o].id+"' data-turbolinks='false'>"+t[o].innerHTML+"</a></li>",t[o].innerHTML+="&nbsp;<a class='button is-text "+("H3"===t[o].tagName?"is-small":"")+" heading-shortcut-link' style='text-decoration:none;' href='#"+t[o].id+"' data-turbolinks='false'><i class='fa fa-link'></i></a>&nbsp;<a class='button "+(GAwesomeData.wiki.bookmarks.indexOf(GAwesomeUtil.getBookmarkLink(t[o].id))>-1?"is-dark":"is-text")+" "+("H3"===t[o].tagName?"is-small":"")+"' style='text-decoration:none;' onclick='GAwesomeUtil.bookmarkWikiSection(this);'><i class='fa fa-bookmark'></i></a>";e+="</ul>",t[t.length-1]&&"H3"===t[t.length-1].tagName&&(e+="</ul>"),$("#submenu").html(e),$("table").addClass("table"),$(".heading-shortcut-link").click(function(){$("html, body").animate({scrollTop:$("#"+this.href.substring(this.href.lastIndexOf("#")+1)).offset().top},172)})}),GAwesomeUtil.populateWikiBookmarks=(()=>{if(GAwesomeData.wiki.bookmarks.length>0){$("#bookmarks-menu").removeClass("is-hidden"),$("#menu-spacer").removeClass("is-hidden"),GAwesomeData.wiki.bookmarks=GAwesomeData.wiki.bookmarks.sort();let e="<ul>";for(let t=0;t<GAwesomeData.wiki.bookmarks.length;t++)e+="<li><a href='"+GAwesomeData.wiki.bookmarks[t]+"' data-turbolinks='false'>"+decodeURI(GAwesomeData.wiki.bookmarks[t]).replace("#"," &raquo; ")+"</a></li>";e+="</ul>",$("#bookmarks-submenu").html(e)}else $("#bookmarks-menu").addClass("is-hidden"),$("#menu-spacer").addClass("is-hidden")}),GAwesomeUtil.publishExtension=(e=>{confirm("Are you sure you want to publish this extension? Everyone will be able to view and use this extension!")&&(NProgress.start(),$(`#publish-${e}`).remove(),$.ajax({type:"POST",url:`/extensions/${e}/publish`,data:{}}).always(()=>{NProgress.done(),NProgress.remove()}))}),GAwesomeUtil.deleteExtension=(e=>{confirm("Are you sure you want to remove this extension? This action is irreversible!")&&(NProgress.start(),$(`#delete-${e}`).parent().parent().remove(),$.ajax({type:"POST",url:`/extensions/${e}/delete`,data:{}}).always(()=>{NProgress.done(),NProgress.remove()}))}),GAwesomeUtil.saveExtension=((e,t)=>{NProgress.start(),hide_update_modal=!0;const o=$("#form").serializeArray();o.find(e=>"code"===e.name).value=GAwesomeData.builder.getValue(),$.ajax({method:"POST",url:t,data:o}).always(function(t){const o=$("#form-submit");NProgress.done(),NProgress.remove(),saveFormState(),"OK"!==t&&200!==t.status&&302!==t.status?(o.find("span:nth-child(1)").html("<i class='fa fa-exclamation'></i>"),o.find("span:nth-child(2)").html("Error")):e?Turbolinks.visit("/extensions/my"):Turbolinks.visit("")})}),GAwesomeUtil.voteExtension=(e=>{const t=$(`#vote-${e}`),o=t.html().trim();t.html("-1"===o?"+1":"-1"),$.post(`/extensions/${e}/upvote`);const s=$(`#points-${e}`);s.html("-1"===o?Number(s.html())-1:Number(s.html())+1)}),GAwesomeUtil.unpublishExtension=(e=>{if(!confirm("Are you sure you want to unpublish this extension? It will no longer be usable or visible by guilds, points are preserved."))return;NProgress.start();const t=$(`#card-${e}`);$.post(`/extensions/${e}/unpublish`),t.remove(),NProgress.done(),NProgress.remove()}),GAwesomeUtil.rejectExtension=(e=>{let t=prompt("Reason to reject:");t||(t="No reason given."),NProgress.start(),$.ajax({method:"POST",url:`/extensions/${e}/reject`,data:{reason:t}}).done(()=>{$(`#card-${e}`).remove(),NProgress.done(),NProgress.remove()})}),GAwesomeUtil.removeExtension=(e=>{let t=prompt("Reason to remove:");t||(t="No reason given."),NProgress.start(),$.ajax({method:"POST",url:`/extensions/${e}/remove`,data:{reason:t}}).done(()=>{$(`#card-${e}`).remove(),NProgress.done(),NProgress.remove()})}),GAwesomeUtil.acceptExtension=(e=>{NProgress.start(),$.post(`/extensions/${e}/accept`).done(()=>{NProgress.done(),NProgress.remove(),Turbolinks.visit("/extensions/gallery")})}),GAwesomeUtil.featureExtension=(e=>{const t=$(`#feature-${e}`),o="Feature"!==t.html().trim();t.html(o?"Feature":"Unfeature"),$.post(`/extensions/${e}/feature`),$(`#featured-${e}`).html(o?"":'<span class="tag is-primary">Featured</span>&nbsp;')}),GAwesomeUtil.installExtension=(e=>{alert("In Progress")}),GAwesomePaths.extensions=(()=>{"/extensions/builder"===window.location.pathname&&(setTimeout(function(){saveFormState()},0),GAwesomeData.builder=CodeMirror.fromTextArea(document.getElementById("builder-code-box"),{mode:"javascript",lineWrapping:!0,lineNumbers:!0,fixedGutter:!0,styleActiveLine:!0,theme:"monokai"}),GAwesomeData.builder.refresh())}),GAwesomeUtil.dashboardWrapper=(e=>"dashboard"!==window.location.pathname.split("/")[1]?"This function can only be executed within the dashboard.":e()),GAwesomeUtil.dashboard.connect=(()=>GAwesomeUtil.dashboardWrapper(()=>{GAwesomeData.dashboard.socket&&GAwesomeData.dashboard.socket.close(),GAwesomeData.dashboard.socket=io(window.location.pathname,{transports:["websocket"]}),GAwesomeData.dashboard.socket.on("update",function(e){hide_update_modal||GAwesomeData.dashboard.svrid!==e||"none"===localStorage.getItem("dashboardUpdates")||($("html").addClass("is-clipped"),$("#update-modal").addClass("is-active"))}),GAwesomeData.dashboard.socket.on("logs",e=>{let t=`[${e.timestamp}] [${e.level}] ${e.message}`;GAwesomeData.dashboard.terminal.print(t),$(".Terminal").animate({scrollTop:$(".Terminal").prop("scrollHeight")},500)})})),GAwesomePaths.landing=(()=>{$(".section-shortcut-link").click(function(){$("html, body").animate({scrollTop:$("#"+this.href.substring(this.href.lastIndexOf("#")+1)).offset().top},172)})}),GAwesomePaths.activity=(()=>{GAwesomeUtil.activityViewportUpdate(GAwesomeListeners.activityMQL),"/activity/users"===window.location.pathname?(document.getElementById("search-button").href="javascript:GAwesomeUtil.searchUsers(document.getElementById('search-input').value);",document.getElementById("search-input").onkeydown=function(){13===event.keyCode&&GAwesomeUtil.searchUsers(this.value)},$.getJSON("/userlist",function(e){searchInputAutocomplete=new autoComplete({selector:"#search-input",minChars:2,source:function(t,o){t=t.toLowerCase(),o(e.filter(function(e){return e.toLowerCase().indexOf(t)>-1}))}})})):(GAwesomeData.activity.guildData={},document.getElementById("search-button").href="javascript:GAwesomeUtil.searchServers(document.getElementById('search-input').value);",document.getElementById("search-input").setAttribute("list","servers"),document.getElementById("search-input").onkeydown=function(){13===event.keyCode&&GAwesomeUtil.searchServers(this.value)},$.getJSON("/serverlist",function(e){searchInputAutocomplete=new autoComplete({selector:"#search-input",minChars:2,source:function(t,o){t=t.toLowerCase(),o(e.filter(function(e){return e.toLowerCase().indexOf(t)>-1}))}})}),GAwesomeUtil.switchActivityLayout(),GAwesomeUtil.showActivitySelections())}),GAwesomePaths.blog=(()=>{if(setTimeout(function(){saveFormState()},0),"/blog/compose"!==window.location.pathname)return;const e=new showdown.Converter({tables:!0,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0,smoothLivePreview:!0,smartIndentationFix:!0});GAwesomeData.blog.editor=new SimpleMDE({element:document.getElementById("composer-content"),forceSync:!0,spellChecker:!1,promptURLs:!0,previewRender:function(t){return $(".editor-preview").addClass("content"),$(".editor-preview-side").addClass("content"),e.makeHtml(t)}})}),GAwesomePaths.wiki=(()=>{if(setTimeout(function(){saveFormState()},0),GAwesomeData.wiki.bookmarks=JSON.parse(localStorage.getItem("wiki-bookmarks"))||[],GAwesomeUtil.populateWikiBookmarks(),"/wiki/edit"!==window.location.pathname)return;const e=new showdown.Converter({tables:!0,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0,smoothLivePreview:!0,smartIndentationFix:!0});GAwesomeData.wiki.editor=new SimpleMDE({element:document.getElementById("composer-content"),forceSync:!0,spellChecker:!1,promptURLs:!0,previewRender:function(t){return $(".editor-preview").addClass("content"),$(".editor-preview-side").addClass("content"),e.makeHtml(t)}})}),GAwesomePaths.dashboard=(()=>GAwesomeUtil.dashboardWrapper(()=>{$(".close-update-modal").unbind(),$(".close-update-modal").click(()=>{$("html").removeClass("is-clipped"),$("#update-modal").removeClass("is-active")}),GAwesomeUtil.dashboard.connect();window.location.pathname.split("/")[2];const e=window.location.pathname.split("/")[3];if("command-options"===e)$("#ban_gif").on("blur",()=>{if("Default"===$("#ban_gif").val())return $("#default_ban_gif").hide(),$("#ban_gif_field").removeClass("has-addons"),$("#ban_gif_preview").attr("src","https://imgur.com/3QPLumg.gif");$("#ban_gif_field").addClass("has-addons"),$("#default_ban_gif").show(),$("#ban_gif_preview").attr("src",$("#ban_gif").val())});else if("name-display"===e){const e=$("#currentExample"),t=$("#name_display-use_nick"),o=$("#name_display-show_discriminator");t.click(()=>{t.is(":checked")&&""!==GAwesomeData.nickname?e.text(GAwesomeData.nickname):e.text(GAwesomeData.username),o.is(":checked")&&e.text(`${e.text().trim()}#${GAwesomeData.discriminator}`)}),o.click(()=>{o.is(":checked")?e.text(e.text()+`#${GAwesomeData.discriminator}`):e.text(e.text().trim().slice(0,-5))})}})),document.addEventListener("turbolinks:load",()=>{GAwesomeUtil.updateHeader(),bulma(),$("html").removeClass("is-clipped"),hide_update_modal=!1,initial_form_state=$("#form").serialize(),GAwesomeData.dashboard.socket&&(GAwesomeData.dashboard.socket.close(),delete GAwesomeData.dashboard.socket),GAwesomeData.section=window.location.pathname.split("/")[1];let e=GAwesomePaths[GAwesomeData.section];""===GAwesomeData.section&&(e=GAwesomePaths.landing),e&&e()});const GAwesomeListeners={};function setUserAutocomplete(e){$.getJSON("/userlist"+(e?"?svrid="+e:""),function(e){new autoComplete({selector:".user-autocomplete",minChars:2,source:function(t,o){t=t.toLowerCase(),o(e.filter(function(e){return e.toLowerCase().indexOf(t)>-1}))}})})}GAwesomeListeners.activityMQL=window.matchMedia("screen and (max-width: 768px)"),GAwesomeListeners.activityMQL.addListener(GAwesomeUtil.activityViewPortUpdate),$(window).scroll(function(){$("#form-buttons")&&$("#form-buttons").is(":visible")?$("#scroll-top-button-container").css("padding-bottom","75px"):$("#scroll-top-button-container").css("padding-bottom","25px"),$(this).scrollTop()>200&&$(this).scrollTop()<$(document).height()-1200?$("#scroll-top-button-container").fadeIn(86):$("#scroll-top-button-container").fadeOut(86)}),$(document).on("turbolinks:click",function(){NProgress.start()}),$(document).on("turbolinks:render",function(){NProgress.done(),NProgress.remove()}),String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)};let keys=[];const konami="38,38,40,40,37,39,37,39,66,65",dolphin="68,69,76,73,71,72,84,69,68,32,68,79,76,80,72,73,78",unknown="38c972419c82c3059933ecefee492ad2";window.addEventListener("keydown",function(e){16!==e.keyCode&&keys.push(e.keyCode),keys.toString().includes(konami)&&(keys=[],document.body.innerHTML=document.body.innerHTML.replace(/GAwesomeBot/g,"TacoBot"),document.body.innerHTML=document.body.innerHTML.split("/static/img/icon.png").join("/static/img/tinytaco.png"),document.getElementById("header").style.backgroundImage="url('/static/img/header-bg-taco.jpg')"),keys.toString().includes(dolphin)&&(keys=[],$("*").contents().filter(function(){return this.nodeType===Node.TEXT_NODE&&""!==this.nodeValue.trim()}).each(function(){let e="";for(let t=0;t<this.nodeValue.length;t++)e+="🐬";this.nodeValue=e})),md5(keys.toString())===unknown&&(keys=[],document.body.innerHTML=document.body.innerHTML.split("/GilbertGobbels/GAwesomeBot").join("/BitQuote/AwesomeBot"),document.body.innerHTML=document.body.innerHTML.replace(/GAwesomeBot/g,"AwesomeBot Neo"),document.body.innerHTML=document.body.innerHTML.split("/static/img/icon.png").join("/static/img/NEO.png"),$("#footerText").html('<strong>AwesomeBot NEO</strong> by BitQuote & <a href="https://github.com/BitQuote">BitQuote</a>. Made with <a href="https://github.com/BitQuote">BitQuote</a> and <a href="https://github.com/BitQuote">BitQuote</a>. Site made with <a href="https://github.com/BitQuote">BitQuote</a> and <a href="https://github.com/BitQuote">BitQuote</a>. Artwork by <a href="https://github.com/BitQuote">BitQuote</a> and <a href="https://github.com/BitQuote">BitQuote</a>. All rights reserved by BitQuote.'),$(".developer-card-name").html("BitQuote").attr("ondblclick",""),$(".developer-card-icon").attr("src","/static/img/bitquote.png"),$(".developer-card-role").html("(Evil) Creator, Bot Killer"))},!0);